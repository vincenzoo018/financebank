@page "/customer/bills"
@layout CustomerLayout

<div class="section-header">
    <h2 class="section-title">Pay Bills</h2>
</div>

<!-- Quick Bill Payment -->
<div style="background: white; border-radius: 16px; padding: 24px; border: 1px solid var(--border); margin-bottom: 24px;">
    <h3 style="font-size: 16px; font-weight: 700; margin-bottom: 16px;">Pay a Bill</h3>
    <form @onsubmit="HandlePayment">
        <div class="form-group">
            <label class="form-label">Select Biller</label>
            <select class="form-control" @bind="selectedBiller" required>
                <option value="">Choose biller...</option>
                <option value="Electric Company">Electric Company</option>
                <option value="Water Company">Water Company</option>
                <option value="Internet Provider">Internet Provider</option>
                <option value="Mobile Provider">Mobile Provider</option>
            </select>
        </div>

        <div class="form-group">
            <label class="form-label">Account Number</label>
            <input type="text" class="form-control" @bind="accountNumber" placeholder="Enter your account number" required />
        </div>

        <div class="form-group">
            <label class="form-label">Amount</label>
            <input type="number" class="form-control" @bind="amount" placeholder="0.00" step="0.01" min="1" required />
        </div>

        @if (!string.IsNullOrEmpty(successMessage))
        {
            <div style="padding: 12px; background: #d1fae5; color: #065f46; border-radius: 12px; margin-bottom: 16px;">
                @successMessage
            </div>
        }

        <button type="submit" class="btn btn-primary" style="width: 100%;">
            Pay Bill
        </button>
    </form>
</div>

<!-- Payment History -->
<div class="section-header">
    <h2 class="section-title">Recent Bill Payments</h2>
</div>

<div class="transaction-list">
    @foreach (var payment in recentPayments)
    {
        <div class="transaction-item">
            <div class="transaction-icon">ðŸ“„</div>
            <div class="transaction-details">
                <div class="transaction-title">@payment.Biller</div>
                <div class="transaction-date">@payment.Date.ToString("MMM dd, yyyy")</div>
            </div>
            <div class="transaction-amount negative">
                -â‚±@payment.Amount.ToString("N2")
            </div>
        </div>
    }
</div>

@code {
    private string selectedBiller = "";
    private string accountNumber = "";
    private decimal amount = 0;
    private string successMessage = "";

    private List<Payment> recentPayments = new();

    protected override void OnInitialized()
    {
        recentPayments = new List<Payment>
        {
            new Payment { Biller = "Electric Company", Date = DateTime.Now.AddDays(-5), Amount = 850 },
            new Payment { Biller = "Internet Provider", Date = DateTime.Now.AddDays(-10), Amount = 1299 },
            new Payment { Biller = "Water Company", Date = DateTime.Now.AddDays(-15), Amount = 450 },
        };
    }

    private void HandlePayment()
    {
        successMessage = $"Successfully paid â‚±{amount:N2} to {selectedBiller}!";
        selectedBiller = "";
        accountNumber = "";
        amount = 0;
    }

    private class Payment
    {
        public string Biller { get; set; } = "";
        public DateTime Date { get; set; }
        public decimal Amount { get; set; }
    }
}
