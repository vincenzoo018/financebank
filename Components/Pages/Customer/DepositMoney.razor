@page "/customer/deposit"
@layout CustomerLayout

<div style="padding: 24px; max-width: 1200px; margin: 0 auto;">
    <!-- Header -->
    <div style="background: linear-gradient(135deg, #059669, #10b981); border-radius: 16px; padding: 24px; margin-bottom: 24px; color: white;">
        <div style="display: flex; align-items: center; gap: 16px;">
            <div style="width: 60px; height: 60px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                <span style="font-size: 32px;">üí∞</span>
            </div>
            <div>
                <h1 style="font-size: 28px; font-weight: 700; margin: 0;">Deposit Money</h1>
                <p style="margin: 4px 0 0; opacity: 0.9; font-size: 16px;">Add funds to your account</p>
            </div>
            <div style="margin-left: auto; text-align: right;">
                <button type="button" @onclick="ShowHistory" style="background: rgba(255,255,255,0.2); border: none; color: white; padding: 12px 20px; border-radius: 8px; cursor: pointer;">
                    üìä History
                </button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 24px;">
        <!-- Deposit Form -->
        <div style="background: white; border-radius: 16px; padding: 32px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
            <form>
                <!-- Deposit Type -->
                <div style="margin-bottom: 24px;">
                    <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 16px; color: #1f2937;">Deposit Type</h3>
                    <select class="form-control" @bind="depositType" style="font-size: 16px; padding: 12px;">
                        <option value="cash">üíµ Cash Deposit</option>
                        <option value="check">üìù Check Deposit</option>
                        <option value="online">üåê Online Transfer</option>
                    </select>
                </div>

                <!-- To Account -->
                <div style="margin-bottom: 24px;">
                    <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 16px; color: #1f2937;">To Account</h3>
                    <div style="border: 2px solid #e5e7eb; border-radius: 12px; padding: 16px; background: #f9fafb;">
                        <div style="font-size: 14px; color: #6b7280; margin-bottom: 8px;">FINSYS Savings Account</div>
                        <div style="font-size: 16px; font-weight: 600; color: #1f2937; margin-bottom: 4px;">****1234</div>
                        <div style="font-size: 20px; font-weight: 700; color: #059669;">‚Ç±25,450.75</div>
                    </div>
                </div>

                <!-- Amount -->
                <div style="margin-bottom: 24px;">
                    <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 16px; color: #1f2937;">Deposit Amount</h3>
                    <div class="form-group">
                        <input type="number" class="form-control" @bind="amount" placeholder="0.00" style="font-size: 24px; font-weight: 600; padding: 16px; text-align: center; color: #059669;" />
                        <div style="text-align: center; margin-top: 8px; font-size: 14px; color: #6b7280;">No processing fee</div>
                    </div>
                </div>

                <!-- Purpose -->
                <div style="margin-bottom: 32px;">
                    <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 16px; color: #1f2937;">Purpose</h3>
                    <textarea class="form-control" @bind="purpose" placeholder="Optional notes about this deposit" rows="3" style="resize: vertical;"></textarea>
                </div>

                <!-- Action Buttons -->
                <div style="display: flex; gap: 12px;">
                    <button type="button" @onclick="ClearForm" style="flex: 1; padding: 16px; background: #f3f4f6; border: none; border-radius: 12px; color: #374151; font-size: 16px; font-weight: 600; cursor: pointer;">
                        Clear
                    </button>
                    <button type="button" @onclick="ProcessDeposit" style="flex: 2; padding: 16px; background: linear-gradient(135deg, #059669, #047857); border: none; border-radius: 12px; color: white; font-size: 16px; font-weight: 600; cursor: pointer;">
                        Deposit Now ‚Üí
                    </button>
                </div>
            </form>
        </div>

        <!-- Sidebar -->
        <div>
            <!-- Quick Actions -->
            <div style="background: white; border-radius: 16px; padding: 24px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-bottom: 24px;">
                <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 16px; color: #1f2937;">Quick Actions</h3>
                <div style="display: flex; flex-direction: column; gap: 12px;">
                    <button type="button" style="padding: 12px 16px; background: #eff6ff; border: 1px solid #3b82f6; border-radius: 8px; color: #1e40af; font-weight: 500; cursor: pointer; text-align: left;">
                        üí∏ Transfer Money
                    </button>
                    <button type="button" style="padding: 12px 16px; background: #fef3c7; border: 1px solid #f59e0b; border-radius: 8px; color: #92400e; font-weight: 500; cursor: pointer; text-align: left;">
                        üí∏ Withdraw Money
                    </button>
                    <button type="button" style="padding: 12px 16px; background: #f0fdf4; border: 1px solid #10b981; border-radius: 8px; color: #065f46; font-weight: 500; cursor: pointer; text-align: left;">
                        üìÑ Pay Bills
                    </button>
                </div>
            </div>

            <!-- Recent Deposits -->
            <div style="background: white; border-radius: 16px; padding: 24px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                    <h3 style="font-size: 18px; font-weight: 600; color: #1f2937;">Recent Deposits</h3>
                    <button type="button" @onclick="ShowHistory" style="font-size: 14px; color: #059669; background: none; border: none; cursor: pointer; font-weight: 500;">View All</button>
                </div>
                
                @foreach (var deposit in recentDeposits.Take(3))
                {
                    <div class="deposit-item" style="padding: 12px; border-radius: 8px; border: 1px solid #e5e7eb; margin-bottom: 8px; cursor: pointer; transition: all 0.2s;">
                        <div style="display: flex; justify-content: space-between; align-items: start;">
                            <div>
                                <div style="font-weight: 600; font-size: 14px; color: #1f2937;">@deposit.Type</div>
                                <div style="font-size: 12px; color: #6b7280; margin-top: 2px;">@deposit.Date.ToString("MMM dd, yyyy")</div>
                            </div>
                            <div style="font-weight: 600; color: #059669;">+‚Ç±@deposit.Amount.ToString("N2")</div>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

<style>
    .deposit-item:hover {
        background: #f0fdf4;
        border-color: #10b981;
    }
</style>

<!-- Transaction History Modal -->
@if (showHistoryModal)
{
    <div style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 1000;" @onclick="CloseHistory">
        <div style="background: white; border-radius: 16px; padding: 32px; max-width: 800px; width: 90%; max-height: 80vh; overflow-y: auto; box-shadow: 0 20px 60px rgba(0,0,0,0.3);" @onclick:stopPropagation="true">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                <h2 style="font-size: 24px; font-weight: 700; color: #1f2937;">Deposit History</h2>
                <button @onclick="CloseHistory" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #6b7280;">&times;</button>
            </div>
            
            <div>
                @foreach (var deposit in recentDeposits)
                {
                    <div style="border: 1px solid #e5e7eb; border-radius: 12px; padding: 16px; margin-bottom: 12px;">
                        <div style="display: flex; justify-content: space-between; align-items: start;">
                            <div style="flex: 1;">
                                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                    <span style="font-size: 20px;">üí∞</span>
                                    <div>
                                        <div style="font-weight: 600; color: #1f2937;">@deposit.Type</div>
                                        <div style="font-size: 12px; color: #6b7280;">@deposit.Reference</div>
                                    </div>
                                </div>
                                <div style="font-size: 14px; color: #6b7280;">@deposit.Purpose</div>
                                <div style="font-size: 12px; color: #9ca3af; margin-top: 4px;">@deposit.Date.ToString("MMM dd, yyyy hh:mm tt")</div>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-weight: 700; font-size: 18px; color: #059669;">+‚Ç±@deposit.Amount.ToString("N2")</div>
                                <div style="font-size: 12px; margin-top: 4px;">
                                    <span style="padding: 4px 8px; background: @(deposit.Status == "Completed" ? "#d1fae5" : "#fef3c7"); color: @(deposit.Status == "Completed" ? "#065f46" : "#92400e"); border-radius: 4px; font-weight: 500;">@deposit.Status</span>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
}


@code {
    private string depositType = "cash";
    private decimal amount = 0;
    private string purpose = "";
    private bool showHistoryModal = false;

    private List<DepositHistory> recentDeposits = new();

    protected override void OnInitialized()
    {
        recentDeposits = new List<DepositHistory>
        {
            new() { Type = "Cash Deposit", Reference = "DEP-001", Amount = 5000, Purpose = "Monthly savings", Date = DateTime.Now.AddHours(-2), Status = "Completed" },
            new() { Type = "Check Deposit", Reference = "DEP-002", Amount = 8500, Purpose = "Salary deposit", Date = DateTime.Now.AddDays(-1), Status = "Completed" },
            new() { Type = "Online Transfer", Reference = "DEP-003", Amount = 2000, Purpose = "Gift from family", Date = DateTime.Now.AddDays(-2), Status = "Pending" },
            new() { Type = "Cash Deposit", Reference = "DEP-004", Amount = 1500, Purpose = "Side income", Date = DateTime.Now.AddDays(-3), Status = "Completed" },
            new() { Type = "Wire Transfer", Reference = "DEP-005", Amount = 12000, Purpose = "Freelance payment", Date = DateTime.Now.AddDays(-4), Status = "Completed" }
        };
    }

    private void ShowHistory()
    {
        showHistoryModal = true;
    }

    private void CloseHistory()
    {
        showHistoryModal = false;
    }

    private void ClearForm()
    {
        depositType = "cash";
        amount = 0;
        purpose = "";
    }

    private void ProcessDeposit()
    {
        // Implement logic to process the deposit
        // Add validation and actual deposit logic here
    }

    public class DepositHistory
    {
        public string Type { get; set; } = "";
        public string Reference { get; set; } = "";
        public decimal Amount { get; set; }
        public string Purpose { get; set; } = "";
        public DateTime Date { get; set; }
        public string Status { get; set; } = "";
    }
}
